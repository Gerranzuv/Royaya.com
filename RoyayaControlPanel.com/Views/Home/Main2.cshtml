@{
    Layout = "~/Views/Shared/_empty.cshtml";
    ViewBag.Title = "Home Page";
    int pageNumber = 0;
}
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="~/MainPageStyle/css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="~/MainPageStyle/css/fontawesome.css">
    <link rel="shortcut icon" href="~/MainPageStyle/img/asset-5.png" type="image/x-icon">
    <link rel="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <link href="~/css/MainPageStyles.css" rel="stylesheet" />
    <style>
        
    </style>
</head>
<body>
    <img class="img img-fluid" src="~/MainPageStyle/img/others.svg" />
    <nav class="navbar navbar-expand-lg navbar-light bg-light" style="width: fit-content;">
        <ul class="navbar-nav mr-auto">
            <li class="nav-item">
                <a class="nav-link text-white" href="@Url.Action("Main", "Home")" style="margin-top: 1px"><span class="ml-1 align-middle"><svg class="svg-inline--fa fa-home fa-w-18 fa-2x" style="height: 30.9px !important;width: 36.4px !important;" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" data-fa-i2svg=""><path fill="currentColor" d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg></span>الرئيسية </a>
            </li>
            @*<li class="nav-item">
                <a class="nav-link text-white" href="@Url.Action("ContactUs", "Home")" ><span class="ml-1 align-middle"><svg class="svg-inline--fa fa-envelope fa-w-16 fa-2x" style="height: 27.7px !i;width: 34.7px !important;" aria-hidden="true" focusable="false" data-prefix="far" data-icon="envelope" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M464 64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V112c0-26.51-21.49-48-48-48zm0 48v40.805c-22.422 18.259-58.168 46.651-134.587 106.49-16.841 13.247-50.201 45.072-73.413 44.701-23.208.375-56.579-31.459-73.413-44.701C106.18 199.465 70.425 171.067 48 152.805V112h416zM48 400V214.398c22.914 18.251 55.409 43.862 104.938 82.646 21.857 17.205 60.134 55.186 103.062 54.955 42.717.231 80.509-37.199 103.053-54.947 49.528-38.783 82.032-64.401 104.947-82.653V400H48z"></path></svg></span><span>اتصل بنا</span></a>
            </li>*@
            
            <li class="nav-item">
                <div class="s128">
                    <form>
                        <div class="inner-form">
                            <div class="row" style="margin-right: unset">
                                <div class="input-field first" id="first">
                                    <input class="input" id="inputFocus" type="text" placeholder="Keyword" oninput="search(document.getElementById('inputFocus').value)" />
                                    <button class="clear" id="clear">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" style="margin-top: -6px;">
                                            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </li>
        </ul>
    </nav>
    
        
    <div class="counter">
        <div class="container" style="margin-top:10px!important;">
            <div class="row">
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="employees text-center" >
                        <p class="counter-count text-center">@ViewBag.numberOfDoneDreams</p>
                        <p class="employee-p">الأحلام المفسرة</p>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12 text-center">
                    <div class="customer">
                        <p class="counter-count text-center">@ViewBag.numberOfActiveUsers</p>
                        <p class="customer-p;text-center">الأحلام قيد التفسير</p>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="design">
                        <p class="counter-count text-center">@ViewBag.numberOfClients</p>
                        <p class="design-p text-center">العملاء</p>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="order text-center">
                        <p class="counter-count text-center">@ViewBag.numberOfInterpreters</p>
                        <p class="order-p">المفسرون</p>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="order">
                        <p class="counter-count"></p>
                        <p class="order-p">@ViewBag.numberOfVisits</p>
                    </div>
                </div>
                <div class="col-lg-2 col-md-2 col-sm-2 col-xs-12">
                    <div class="order">
                        <p class="counter-count">652</p>
                        <p class="order-p">المتواجدون الآن</p>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
    <div class="row text-center">
        <div class="col-md-3"></div>
        <div class="col-md-3">
            <p style="float:left">
                <button class="btn btn-primary btn-default" style="background-color:#0984a8" onclick="roaashow(false);">
                   الأحلام قيد التفسير
                </button>
            </p>
        </div>
        <div class="col-md-3">
            <p style="float:right">
                <button class="btn btn-primary btn-default" style="background-color:#0984a8" onclick="roaashowDone(false);">
                    الأحلام المفسرة
                </button>
            </p>
        </div>
        <div class="col-md-3"></div>
    </div>
    @*<div class="row text-center btns mt-4 pt-4">
        <a href="#"><img onclick="roaashow(false);" class="rounded affix" src="~/MainPageStyle/img/Group 1697.svg" style="width:258px ;height:60px" /></a>
        <a href="#"><img onclick="roaashowDone(false);" class="rounded affix" src="~/MainPageStyle/img/Group 1668.svg" style="width:258px ;height:60px" /><span></span></a>
    </div>*@
    <div class="icon-bar" style="top:50%">
        <div class="dropdown">
            <button class="dropbtn">أرسل حلمك </button>
            <div class="dropdown-content">
                <a href="#" class="google">
                    <img src="~/Images/google-play.png" style="height:25px;width:25px" />
                </a>
                <a href="#" class="linkedin">
                    <img src="~/Images/app-store.png" style="height:25px;width:25px" />
                </a>
                
            </div>
        </div>
        
    </div>
    <div class="icon-bar" style="top:35%">
        <a>
            <div>
                هل انت مفسر؟
            </div>
            <div>
                قم بإجراء الاختبار الآن
            </div>
        </a>

    </div>
    <!-- The social media icon bar -->
    <div class="icon-bar" style="float:left!important;">
        <a href="#" class="google">
            <img src="~/Images/google-play.png" style="height:25px;width:25px" />
        </a>
        <a href="#" class="linkedin">
            <img src="~/Images/app-store.png" style="height:25px;width:25px" />
        </a>
        <a href="#" class="facebook"><i class="fa fa-facebook"></i></a>
        <a href="#" class="snap"><i class="fa fa-snapchat"></i></a>
       
       
    </div>
    

    <div class="container row" style="margin-top:-10px"  id="Dream_Body">
        <div id="Body">
            
        </div>
    </div>
    @*<div class="row center" style="text-align: center;display: inline-block;margin-left: 48%;;">
        <a href="#" style="display: inline-block"><img onclick="loadMore();" class="rounded affix" src="~/MainPageStyle/img/Group 2020.svg" style="width:258px ;height:60px" /></a>
    </div>*@
</body>





@section Scripts
{
    <script src="~/MainPageStyle/js/date.format.js"></script>
    <script src="~/MainPageStyle/js/fontawesome.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    
    <script type="text/javascript">
        var pagenumber =1;
        $('.counter-count').each(function () {
            $(this).prop('Counter', 0).animate({
                Counter: $(this).text()
            }, {
                    duration: 5000,
                    easing: 'swing',
                    step: function (now) {
                        $(this).text(Math.ceil(now));
                    }
                });
        });
        var currentValue = "Done";
        $(document).ready(function () {
            pagenumber = 1;
            roaashow(false);
            pagenumber++;

        });

        function loadMore() {
            if (currentValue == "Done") {
                roaashowDone(true);

            }

            else {
                roaashow(true);
            }
            pagenumber++;
        };
        function roaashow(loadmore) {
            currentValue = "Active";
            if (loadmore == false) {
                $('#Dream_Body div').remove();
                pagenumber = 1;
            }

            $.ajax({
                type: "GET",
                url: '@Url.Action("GetDreams", "Dreams")' + "?page=" + pagenumber + "&status=Active",
                    dataType: "json",
                    data: {},
                    success: function (data) {
                        $.each(data, function (index, value) {
                            var dateString = value.CreationDate;
                            var date = new Date(parseInt(dateString.substr(6)));

                            var row = "<div id='Body' class='col-sm-6 col-lg-4'>"+
                            "<a href='Home/Details/"+value.id+"\'><div class='card rounded-card ' style='width: 489.68px;height: 272.49px; background-color: #3C4BFF; color: white'>"+
                            "<div class='title text-right '>"+
                                "<p class='pr-4 pt-2' style='font-family:Droid Arabic Kufi;font-size:18px;color:white;'>" + (value.pathCost == 0 ? "رؤية مجانية " : ("رؤية مدفوعة والتكلفة " + value.pathCost))+"</p><i class='fas fa- cloud'></i>"+
                                "<hr style='background-color:white'>" +
                            "</div>"+
                            "<div class='card-body'>"+
                                "<a href='Home/Details/" + value.id + "\'style='color: #3C4BFF'><p class='card-text text-right' style='font-family:Droid Arabic Kufi;font-size:18px;color:white'>" + value.Description.substring(0, 80)+"</p>"+
                            "</a></div>"+
                            "<hr style='background-color:white'>"+
                            "<div class='d-flex bd-highlight justify-content-between'>"+
                                "<div class='p-2 bd-highlight' style='font-family:Droid Arabic Kufi;font-size:17px;color:white !important;' >" + date.format("dd/mm/yyyy")+"</div>"+
                                "<div class='p-2 flex-shrink-1 bd-highlight'><span class='pl-1'>" + value.numberOfViews +"<span> مشاهدة </span>"+
                                "<span>" + value.numberOfLikes +"</span><span> إعجاب </span></div>"+
                            "</div>"+

                                "</div></a></div>";
                            var row2='<div class="col-md-12">'+
'            <div class="card" style="margin-top:10px">'+
'                <div class="card-header">'+
'                    <div style="margin-right:15px"> <span>الرؤية رقم '+value.id+'</span>'+
                                '                    <span style="float:left">   <i class="fa fa-money" style="font-size: x-large"> </i> ' + (value.pathCost > 0 ? " &nbasp; رؤية مدفوعة" : "&nbsp;رؤية مجانية") +'</span>'+
'                    </div>'+
                                '                    <div style="margin-right:10px">' + date.format("dd/mm/yyyy")+'</div style="margin-right:10px">'+
'                </div>'+
'                <div class="card-body">'+
'                    <div class="card-title"> '+
'                         نص الرؤية'+
'                        <img src="/Images/dream.png" style="height:30px;width:30px;margin-top:-10px" />'+
'                    </div>'+
                                '                    <div class="card-text">' + value.Description+'</div>'+
'                   <hr />'+
'                    <div class="card-title">'+
'                        <span> التفسير'+
''+
'                            <img src="/Images/book.png" style="height:30px;width:30px;margin-top:-10px" />'+
'                        </span>'+
                                '                        <span style="float:left">المفسر ' + value.interpretatorName+'</span>'+
'                    </div>'+
'                    <div class="card-text">'+
'                        <div>لم يتم تفسير الرؤيا حتى الآن</div>'+
'                        <div style="float:left"></div>'+
'                    </div>'+
'                    '+
'                </div>'+
'                <div class="card-footer">'+
'                   <span style="float:left">     <i class="fa fa-eye">  </i> '+ value.numberOfViews +'</span> '+
'                   <span style="float:left"><i class="fa fa-heart"> </i> '+value.numberOfLikes+'</span>'+
'                </div>'+
'            </div>'+
'        </div>';


                            $('#Dream_Body').append(row2);
                        });

                    }
                });

        }


        function roaashowDone(loadmore) {
            currentValue = "Done";
            if (loadmore == false) {
                $('#Dream_Body div').remove();
                @{
                    pageNumber = 1;
                };
            }
                $.ajax({
                    type: "GET",
                    url:'@Url.Action("GetDreams", "Dreams")'+"?page=" + pagenumber + "&status=Done",
                    dataType: "json",
                    data: {},
                    success: function (data) {
                        $.each(data, function (index, value) {
                            var dateString = value.CreationDate;
                            var date = new Date(parseInt(dateString.substr(6)));
                            var dateString2 = value.ExplanationDate;
                            var date2 = new Date(parseInt(dateString2.substr(6)));
                            var row = "<div id='Body' class='col-sm-6 col-lg-4'>" +
                                "<a href='Home/Details/" + value.id + "\'><div class='card rounded-card ' style='width: 489.68px;height: 272.49px; background-color: #3C4BFF; color: white'>" +
                                "<div class='title text-right '>" +
                                "<p class='pr-4 pt-2' style='font-family:Droid Arabic Kufi;font-size:18px;color:white;'>" + (value.pathCost == 0 ? "رؤية مجانية " : ("رؤية مدفوعة والتكلفة " + value.pathCost)) + "</p><i class='fas fa- cloud'></i>" +
                                "<hr style='background-color:white'>" +
                                "</div>" +
                                "<div class='card-body'>" +
                                "<a href='Home/Details/" + value.id + "\'style='color: #3C4BFF'><p class='card-text text-right' style='font-family:Droid Arabic Kufi;font-size:18px;color:white'>" + value.Description.substring(0, 80) + "</p>" +
                                "</a></div>" +
                                "<hr style='background-color:white'>" +
                                "<div class='d-flex bd-highlight justify-content-between'>" +
                                "<div class='p-2 bd-highlight' style='font-family:Droid Arabic Kufi;font-size:17px;color:white !important;' >" + date.format("dd/mm/yyyy") + "</div>" +
                                "<div class='p-2 flex-shrink-1 bd-highlight'><span class='pl-1'>" + value.numberOfViews + "<span> مشاهدة </span>" +
                                "<span>" + value.numberOfLikes + "</span><span> إعجاب </span></div>" +
                                "</div>" +

                                "</div></a></div>";

                            var row2 = '<div class="col-md-12">' +
                                '            <div class="card" style="margin-top:10px">' +
                                '                <div class="card-header">' +
                                '                    <div style="margin-right:10px"> <span>الرؤية رقم ' + value.id + '</span>' +
                                '                    <span style="float:left">   <i class="fa fa-money" style="font-size: x-large"> </i>' + (value.pathCost>0?" &nbasp; رؤية مدفوعة":"&nbsp;رؤية مجانية") + '</span>' +
                                '                    </div>' +
                                '                    <div style="margin-right:10px">' + date.format("dd/mm/yyyy") + '</div style="margin-right:10px">' +
                                '                </div>' +
                                '                <div class="card-body">' +
                                '                    <div class="card-title"> ' +
                                '                         نص الرؤية' +
                                '                        <img src="/Images/dream.png" style="height:30px;width:30px;margin-top:-10px" />' +
                                '                    </div>' +
                                '                    <div class="card-text">' + value.Description+ '</div>' +
                                '                   <hr />' +
                                '                    <div class="card-title">' +
                                '                        <span> التفسير' +
                                '' +
                                '                            <img src="/Images/book.png" style="height:30px;width:30px;margin-top:-10px" />' +
                                '                        </span>' +
                                '                        <span style="float:left">المفسر ' + value.interpretatorName + '</span>' +
                                '                    </div>' +
                                '                    <div class="card-text">' +
                                '                        <div>' + value.Explanation + '</div>' +
                                '                        <div style="float:left">' + date2.format("dd/mm/yyyy")  + '</div>' +
                                '                    </div>' +
                                '                    ' +
                                '                </div>' +
                                '                <div class="card-footer">' +
                                '                   <span style="float:left">     <i class="fa fa-eye">  </i> ' + value.numberOfViews + '</span> ' +
                                '                   <span style="float:left"><i class="fa fa-heart"> </i> ' + value.numberOfLikes + '</span>' +
                                '                </div>' +
                                '            </div>' +
                                '        </div>';
                            $('#Dream_Body').append(row2);
                        });

                    }
                });

        }


        function search(loadmore) {
            $('#Dream_Body div').remove();
            $.ajax({
                type: "GET",
                url: 'GetDreams?searchString=' + loadmore,
                dataType: "json",
                data: { },
                    success: function (data) {
                        $.each(data, function (index, value) {
                            var dateString = value.CreationDate;
                            var date = new Date(parseInt(dateString.substr(6)));
                            var row = "<div id='Body' class='col-sm-6 col-lg-4'>" +
                                "<a href='Home/Details/" + value.id + "\'><div class='card rounded-card ' style='width: 489.68px;height: 272.49px; background-color: #3C4BFF; color: white'>" +
                                "<div class='title text-right '>" +
                                "<p class='pr-4 pt-2' style='font-family:Droid Arabic Kufi;font-size:18px;color:white;'>" + (value.pathCost == 0 ? "رؤية مجانية " : ("رؤية مدفوعة والتكلفة " + value.pathCost)) + "</p><i class='fas fa- cloud'></i>" +
                                "<hr style='background-color:white'>" +
                                "</div>" +
                                "<div class='card-body'>" +
                                "<a href='Home/Details/" + value.id + "\'style='color: #3C4BFF'><p class='card-text text-right' style='font-family:Droid Arabic Kufi;font-size:18px;color:white'>" + value.Description.substring(0, 80) + "</p>" +
                                "</a></div>" +
                                "<hr style='background-color:white'>" +
                                "<div class='d-flex bd-highlight justify-content-between'>" +
                                "<div class='p-2 bd-highlight' style='font-family:Droid Arabic Kufi;font-size:17px;color:white !important;' >" + date.format("dd/mm/yyyy") + "</div>" +
                                "<div class='p-2 flex-shrink-1 bd-highlight'><span class='pl-1'>" + value.numberOfViews + "<span> مشاهدة </span>" +
                                "<span>" + value.numberOfLikes + "</span><span> إعجاب </span></div>" +
                                "</div>" +

                                "</div></a></div>";
                            $('#Dream_Body').append(row);
                        });

                    }
                });

        }


        var btnDelete = document.getElementById('clear');
        var inputFocus = document.getElementById('inputFocus');
        btnDelete.addEventListener('click', function (e) {
            e.preventDefault();
            inputFocus.value = ''
        })
        document.addEventListener('click', function (e) {
            if (document.getElementById('first').contains(e.target)) {
                inputFocus.classList.add('isFocus');
            }
            else {
                // Clicked outside the box
                inputFocus.classList.remove('isFocus')
            }
        });

        $(window).scroll(function () {
            if ($(window).scrollTop()  == $(document).height() - $(window).height()) {
                // ajax call get data from server and append to the div
                loadMore();
            }
        })

    </script>
}
